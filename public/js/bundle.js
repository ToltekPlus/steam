(()=>{var e={399:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={USER:1,CHAR:2,MASK:3}},643:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!e)return[];for(var n=[],a=!1,r=0;r<e.length;r++){var s=t[e[r]];if(a&&s&&(s=null,a=!1),s)s.regexp&&n.push(s);else{if(!a&&"\\"===e[r]){a=!0;continue}a=!1,n.push({char:e[r],next:null})}}return n}},842:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=e.data,n=e.input,a=void 0===n?"":n,s=e.selection,o=e.mask,i=e.maskChar,c=e.maskString,l=[],u="",d=0,m=0,h=0,f=0;o[d];){var p=t.length>m?t[m]:null,v=o[d],g=null;if(s.start<=d&&h<a.length&&(g=a.slice(h)),v.char&&(g&&g[0]===v.char?h++:(p&&(p.char===v.char||p.type!==r.default.USER)||a)&&m++,l.push({char:v.char,type:r.default.CHAR}),g&&f++,u+=v.char),v.regexp){var k=null;if(g){for(var y=0;!v.regexp.test(g[y])&&g.length>y;)y++,h++;g.length>y&&(h++,f++,m++,k=g[y],l.push({char:k,type:r.default.USER}),u+=k)}if(!k){if(p&&p.type===r.default.CHAR&&t.length>m+1){m++;continue}p&&p.type===r.default.USER&&v.regexp.test(p.char)?(l.push({char:p.char,type:r.default.USER}),u+=p.char,m++):(k=c?c[d]:i,l.push({char:k,type:r.default.MASK}),t.length>d&&m++,u+=k)}}d++}for(var w=s.start+f,S=l.length-1,_=0;S>=0&&l[S].type!==r.default.USER;)l[S].type===r.default.MASK&&(_=0),l[S].type===r.default.CHAR&&_++,S--;S+=_;for(var b="",C=0;C<=S;C++)b+=l[C].char;return{value:l,visibleValue:b,maskedValue:u,selection:{start:w,end:w}}};var a,r=(a=n(399))&&a.__esModule?a:{default:a}},478:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.value,n=e.selection,a=e.reformat,s=(e.mask,e.maskChar),o=e.maskString;if(n.end<n.start){var i=n.end;n.end=n.start,n.start=i}return n.start===n.end?t:t.length>n.start?t.slice(0,n.start).concat(function(){if(a)return"";if(o){for(var e=[],t=n.start;t<n.end;t++)e.push({char:o[t],type:r.default.MASK});return e}return function(e){for(var t=[],n=0;n<e;n++)t.push({char:s,type:r.default.MASK});return t}(n.end-n.start)}(),t.slice(n.end,t.length)):t};var a,r=(a=n(399))&&a.__esModule?a:{default:a}},217:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createInput=t.defaults=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=c(n(643)),s=c(n(842)),o=c(n(478)),i=c(n(399));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){var n=t.value,a=t.mask,s=t.reformat,o=t.maskFormat,i=t.maskChar,c=t.maskString;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),c&&c.length!==a.length)throw new Error("maskString must have same length as mask");if(i.length>1)throw new Error("maskChar must have only 1 char");this._maskString=c,this._maskChar=i,this._reformat=s,this.selection={start:0,end:0},this.setMaskFormat(o),this._mask=(0,r.default)(a,this._maskFormat),this.setValue(n)}return a(e,[{key:"setMaskFormat",value:function(e){this._maskFormat=e.reduce((function(e,t){return e[t.str]=t,e}),{})}},{key:"input",value:function(e){var t=this._value,n=void 0;this._reformat?n=this._reformat({data:t,input:e,selection:this.selection}):(t=(0,o.default)({value:t,selection:this.selection,mask:this._mask,maskChar:this._maskChar,maskString:this._maskString}),this.selection.end=this.selection.start,n=(0,s.default)({data:t,input:e,selection:this.selection,mask:this._mask,maskChar:this._maskChar,maskString:this._maskString})),this._value=n.value,this._maskedValue=n.maskedValue,this._visibleValue=n.visibleValue,this.setSelection(n.selection)}},{key:"setSelection",value:function(e){var t=e.start,n=e.end;this.selection={start:t,end:n}}},{key:"getSelection",value:function(){return{start:this.selection.start,end:this.selection.end}}},{key:"backspace",value:function(){this.removePreviosOrSelected()}},{key:"paste",value:function(e){this.input(e)}},{key:"setMask",value:function(e){this._mask=(0,r.default)(e,this._maskFormat),this.setValue(this._value)}},{key:"getState",value:function(){return{value:this.getValue(),maskedValue:this.getMaskedValue(),visibleValue:this.getVisibleValue(),selection:this.getSelection()}}},{key:"getValue",value:function(){return this._value}},{key:"setReformat",value:function(e){this._reformat=e,this.setValue(this._value)}},{key:"getMaskedValue",value:function(){return this._maskedValue}},{key:"getVisibleValue",value:function(){return this._visibleValue}},{key:"setMaskChar",value:function(e){if(e.length>1)throw new Error("maskChar must have only 1 char");this._maskChar=e,this.setValue(this._value)}},{key:"setMaskString",value:function(e){if(e&&e.length!==this._mask.length)throw new Error("maskString must have same length as mask");this._maskString=e,this.setValue(this._value)}},{key:"removePreviosOrSelected",value:function(){this.selection.start===this.selection.end&&(this.selection.start=this.selection.end-1,this.selection.start<0&&(this.selection.start=0)),this.input("")}},{key:"removeNextOrSelected",value:function(){this.selection.start===this.selection.end&&this.selection.end++,this.input("")}},{key:"setValue",value:function(e){var t=void 0;if(this._reformat)t=this._reformat({data:e,selection:this.selection});else{var n=e;if(!Array.isArray(n)){n=[];for(var a=0;a<e.length;a++)n.push({char:e[a],type:i.default.USER})}t=(0,s.default)({data:n,selection:this.selection,mask:this._mask,maskChar:this._maskChar,maskString:this._maskString})}this._value=t.value,this._maskedValue=t.maskedValue,this._visibleValue=t.visibleValue,this.setSelection(t.selection)}}]),e}(),u=t.defaults={maskFormat:[{str:"0",regexp:/[0-9]/},{str:"*",regexp:/./},{str:"a",regexp:/[a-zA-Z]/}],maskChar:"",showMask:!1,removeSelectedRange:o.default};t.createInput=function(e){var t=e.value,n=e.maskString,a=e.mask,r=e.reformat,s=e.maskFormat,o=void 0===s?u.maskFormat:s,i=e.maskChar,c=r,d=a;return c||d?c&&(d=null):c=function(e){return e},new l({value:t,mask:d,reformat:c,maskFormat:o,maskChar:void 0===i?u.maskChar:i,maskString:n})}},698:(e,t,n)=>{"use strict";var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(217),o=(a=n(626))&&a.__esModule?a:{default:a},i=function(){function e(t,n){var a=this,r=n.mask,o=void 0===r?s.defaults.mask:r,i=n.value,c=void 0===i?"":i,l=n.reformat,u=n.maskString,d=n.maskChar,m=void 0===d?s.defaults.maskChar:d,h=n.maskFormat,f=void 0===h?s.defaults.maskFormat:h,p=n.showMask,v=n.alwaysShowMask,g=n.onChange;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.showValue=function(){a.showMask&&(a.canSetSelection||a.props.alwaysShowMask)?a.element.value=a.input.getMaskedValue():a.element.value=a.input.getVisibleValue()},this.setSelection=function(){if(a.canSetSelection){var e=a.input.getSelection();a.element.setSelectionRange(e.start,e.end),(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){return setTimeout(e,0)})((function(){return a.element.setSelectionRange(e.start,e.end)}))}},this.onPaste=function(e){e.preventDefault(),a.getSelection(),a.input.paste(e.clipboardData.getData("Text")),a.showValue(),setTimeout(a.setSelection,0),a.props.onChange&&a.props.onChange(e)},this.onChange=function(e){var t;t=a.showMask&&(a.canSetSelection||a.props.alwaysShowMask)?a.input.getMaskedValue():a.input.getVisibleValue(),e.target.value!==t&&(a.getSelection(),a.input.setValue(e.target.value),a.showValue(),setTimeout(a.setSelection,0)),a.props.onChange&&a.props.onChange(e)},this.onKeyPress=function(e){e.metaKey||e.altKey||e.ctrlKey||"Enter"===e.key||(e.preventDefault(),a.getSelection(),a.input.input(e.key||e.data||String.fromCharCode(e.which)),a.showValue(),a.setSelection(),a.props.onChange&&a.props.onChange(e))},this.onKeyDown=function(e){8===e.which&&(e.preventDefault(),a.getSelection(),a.input.removePreviosOrSelected(),a.showValue(),a.setSelection(),a.props.onChange&&a.props.onChange(e)),46===e.which&&(e.preventDefault(),a.getSelection(),a.input.removeNextOrSelected(),a.showValue(),a.setSelection(),a.props.onChange&&a.props.onChange(e))},this.onFocus=function(){a.canSetSelection=!0},this.onBlur=function(){a.canSetSelection=!1},this.input=this.input=(0,s.createInput)({value:c,reformat:l,maskString:u,maskChar:m,mask:o,maskFormat:f}),this.props={mask:o,value:c,reformat:l,maskChar:m,maskFormat:f,maskString:u,showMask:p,alwaysShowMask:v,onChange:g},this.showMask=v||p,this.element=t,this.showValue(),this.subscribe()}return r(e,[{key:"getSelection",value:function(){this.input.setSelection({start:this.element.selectionStart,end:this.element.selectionEnd})}},{key:"subscribe",value:function(){this.unsubscribe={onPaste:(0,o.default)(this.element,"paste",this.onPaste),onKeyDown:(0,o.default)(this.element,"keydown",this.onKeyDown),onKeyPress:(0,o.default)(this.element,this.keyPressPropName(),this.onKeyPress),onChange:(0,o.default)(this.element,"change",this.onChange),onFocus:(0,o.default)(this.element,"focus",this.onFocus),onBlur:(0,o.default)(this.element,"blur",this.onBlur)}}},{key:"keyPressPropName",value:function(){return"undefined"!=typeof navigator&&navigator.userAgent.match(/Android/i)?"beforeinput":"keypress"}},{key:"setProps",value:function(e){var t=e.mask,n=e.value,a=e.reformat,r=e.maskString,s=e.maskChar,o=e.maskFormat,i=e.showMask,c=e.alwaysShowMask,l=e.onChange,u=!1;this.props.onChange!==l&&(this.props.onChange=l),this.props.alwaysShowMask===c&&this.props.showMask===i||(this.showMask=c||i,this.props.alwaysShowMask=c,this.props.showMask=i,u=!0),o&&o!==this.props.maskFormat&&(this.input.setMaskFormat(o),this.props.maskFormat=o,u=!0),t!==this.props.mask&&(this.input.setMask(t),this.props.mask=t,u=!0),r!==this.props.maskString&&(this.input.setMaskString(r),this.props.maskString=r,u=!0),s!==this.props.maskChar&&(this.input.setMaskChar(s),this.props.maskChar=s,u=!0),a!==this.props.reformat&&(this.input.setReformat(a),this.props.reformat=a,u=!0),n!==this.props.value&&(this.input.setValue(n),this.props.value=n,u=!0),u&&(this.showValue(),this.setSelection())}},{key:"destroy",value:function(){this.unsubscribe.onPaste(),this.unsubscribe.onKeyDown(),this.unsubscribe.onKeyPress(),this.unsubscribe.onChange(),this.unsubscribe.onFocus(),this.unsubscribe.onBlur()}}]),e}();t.Z=i},379:e=>{"use strict";var t=[];function n(e){for(var n=-1,a=0;a<t.length;a++)if(t[a].identifier===e){n=a;break}return n}function a(e,a){for(var s={},o=[],i=0;i<e.length;i++){var c=e[i],l=a.base?c[0]+a.base:c[0],u=s[l]||0,d="".concat(l," ").concat(u);s[l]=u+1;var m=n(d),h={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==m)t[m].references++,t[m].updater(h);else{var f=r(h,a);a.byIndex=i,t.splice(i,0,{identifier:d,updater:f,references:1})}o.push(d)}return o}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var s=a(e=e||[],r=r||{});return function(e){e=e||[];for(var o=0;o<s.length;o++){var i=n(s[o]);t[i].references--}for(var c=a(e,r),l=0;l<s.length;l++){var u=n(s[l]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}s=c}}},569:e=>{"use strict";var t={};e.exports=function(e,n){var a=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,r&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(a,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},626:e=>{!function(){"use strict";function t(e,t,n,a){var r="removeEventListener",s=function(){e[r](t,n)};return e.addEventListener?(e.addEventListener(t,n,a),s):e.attachEvent?(t="on"+t,e.attachEvent(t,n),r="detachEvent",s):e.on?(e.on(t,n),r="off",s):void 0}t.define=function(e,t){return function(n,a,r,s){return n[e](a,r,s),function(){n[t](a,r)}}},e.exports=t}()},619:()=>{const e=document.querySelectorAll(".dropdown:not(.is-hoverable)");if(e.length>0){for(const t of e)t.addEventListener("click",(function(e){e.stopPropagation(),t.classList.toggle("is-active")}));document.addEventListener("click",(function(e){t()}))}function t(){for(const t of e)t.classList.remove("is-active")}document.addEventListener("keydown",(function(e){const n=e||window.event;"Esc"!==n.key&&"Escape"!==n.key||t()}))},72:()=>{const e=function(e){e.preventDefault(),e.target.classList.remove("animate"),e.target.classList.add("animate"),setTimeout((function(){e.target.classList.remove("animate")}),700)},t=document.querySelectorAll(".buy");for(const n of t)n.addEventListener("click",e,!1)},514:()=>{const e=document.querySelector("#file-js-example input[type=file]");e.addEventListener("change",(()=>{e.files.length>0&&(document.querySelector("#file-js-example .file-name").textContent=e.files[0].name)}))},59:()=>{document.getElementById("search").addEventListener("click",(()=>{const e="is-hidden",t=document.getElementsByClassName(e);for(;t.length>0;)t[0].classList.remove(e);document.getElementById("navigation").classList.add(e)}))}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};n.r(e);var t={};n.r(t);var a=n(379),r=n.n(a),s=n(795),o=n.n(s),i=n(569),c=n.n(i),l=n(565),u=n.n(l),d=n(216),m=n.n(d),h=n(589),f=n.n(h),p={};function v(e,t,n=""){const a=new Headers;return n&&a.append("Content-Type",n),async e=>{const n=await fetch(t,{method:"POST",body:e,headers:a});if(!n.ok)throw new Error(`Ошибка по адресу ${url}, статус ошибки ${fetchResp.status}`);return await n.text()}}function g(){const e=document.querySelectorAll('input[type="text"]:not(.search-block)'),t=document.querySelectorAll("textarea"),n=k(e,e.length),a=k(t,t.length);return!(!n||!a)}function k(e,t){if(0===e.length)return!0;for(let n=0;n<t;++n)if(!e[n].value)return!1;return!0}function y(e,t="success"){Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({icon:t,text:e})}function w(e){e&&window.setTimeout((function(){window.location=e}),2e3)}function S(e,t){e.reset(),document.querySelector("#file").value="",document.querySelector(t).textContent="Ничего не добавлено"}function _(e){const t=window.location.origin+window.location.pathname;return e.filter((e=>e.page===t.split("/").pop()))}function b(e){return async()=>{const t=await fetch(e,{method:"POST"});if(!t.ok)throw new Error(`Ошибка по адресу ${url}, статус ошибки ${fetchResp.status}`);return await t.text()}}function C(e){const t=JSON.parse(localStorage.getItem("steamCart")).filter((t=>t.id!==e));localStorage.setItem("steamCart",JSON.stringify(t))}p.styleTagTransform=f(),p.setAttributes=u(),p.insert=c().bind(null,"head"),p.domAPI=o(),p.insertStyleElement=m(),r()(e.default,p),e.default&&e.default.locals&&e.default.locals;const E=document.querySelector("#briefCart");function M(){if(E){const e=JSON.parse(localStorage.getItem("steamCart")),t={header:"application/x-www-form-urlencoded"},n=document.querySelector("#cartContent"),a=document.createElement("div");a.classList.add("cart-products");const r=document.createElement("div");r.classList.add("product-in-cart");const s=document.createElement("div");if(s.classList.add("product-in-cart__final-price"),0===e.length){const e=document.createElement("div");e.classList.add("empty-cart"),e.innerHTML="<div style='text-align: center;'>Корзина пустая :(</div>",n.append(e)}let o=0;const i="cart/brief",c=[];for(const t of e)c.push(Number.parseInt(t.id));v(0,i,t.header)(c).then((t=>{const i=JSON.parse(t);for(const[t,c]of i.entries())o+=e[t].count*c.price,r.innerHTML+=`<div class='product-in-cart__title'>${c.name_game}<span class='product-in-cart__count'>(x${e[t].count})</span><div class='product-in-cart__price'>${c.price}<label class='product-in-cart__delete' data-el='${e[t].id}' game_id='${e[t].id}'>удалить</label></div></div>`,s.innerHTML=`<div class='product-in-cart__price'>Финальная цена: ${o}</div><div class='arange'><a href='/basket'>Оформить</a></div>`,a.append(r),a.append(s),n.append(a)})).catch((e=>{console.log(e)})),setTimeout(x,1e3)}}function x(){for(const e of document.querySelectorAll(".product-in-cart__delete"))e.addEventListener("click",(e=>{C(e.target.dataset.el);const t=document.querySelectorAll(".cart-products")[0];t&&t.remove(),M()}))}let L;document.querySelector("#briefCart").addEventListener("click",(function(e){const t=document.querySelectorAll(".cart-products")[0];t&&t.remove(),M()}));for(const e of document.querySelectorAll(".buy"))e.addEventListener("click",(()=>T(e.id)));function T(e){if(b("get_auth")().then((e=>{0===e.length&&(y("Вы не авторизованы","error"),L=0)})).catch((e=>console.error(e))),null!=L)return!1;var t=document.getElementById(e).dataset.base_price,n=document.getElementById(e).dataset.tax,a=t*(1-n/100);const r=JSON.parse(localStorage.getItem("steamCart"))||[];let s=r.find((t=>t.id===e));s?(s.count=s.count+1,s.finalPrice=Math.round(a*s.count)):(s={id:e,game_id:e,tax:n,count:1,finalPrice:Math.round(a)},r.push(s)),localStorage.setItem("steamCart",JSON.stringify(r)),M(),y(`Товар под номером ${e} в корзине`)}document.addEventListener("DOMContentLoaded",(()=>{if("game"==window.location.pathname){let e=document.getElementsByClassName("buy")[0];e.addEventListener("click",(()=>(0,t.addGameToCart)(e.id)))}const e=_([{page:"add",action:"store",redirect:"",message:"Данные добавлены",message_error:"Произошла ошибка"},{page:"images",action:"store",redirect:"",message:"Данные добавлены",message_error:"Произошла ошибка"},{page:"edit",action:"update",redirect:"",message:"Данные обновлены",message_error:"Произошла ошибка"},{page:"list",action:"delete",redirect:"list",message:"Данные удалены",message_error:"Произошла ошибка"},{page:"basket",action:"getProducts",header:"application/x-www-form-urlencoded"}]).shift(),n=v(FormData,e.action),a=document.querySelectorAll("form");for(const t of a)t.addEventListener("submit",(function(a){const r=g();a.preventDefault();const s=new FormData(this);0==r?y("Не все данные введены","error"):n(s).then((n=>{""==n.trim()?y(e.message):y(e.message_error,"error"),S(t,"#file-js-example .file-name")})).catch((e=>console.error(e))),setTimeout(w(e.redirect),2e3)}))})),document.addEventListener("DOMContentLoaded",(()=>{const e="application/x-www-form-urlencoded";let t;document.querySelector("#order").addEventListener("click",(function(){if(b("get_auth")().then((e=>{0===e.length&&(y("Вы не авторизованы","error"),t=0)})).catch((e=>console.error(e))),null!=t)return!1;const n="basket/getOrder",a=JSON.parse(localStorage.getItem("steamCart"));let r=[];for(const e of a)r.push(JSON.stringify(e));v(0,n,e)(r,n,e).then((e=>{1==e?(w("basket/success"),localStorage.clear("steamCart")):y("На счёте не достаточно средств для совершения покупки","error")})).catch((e=>{console.log(e)}))}))}));const V=_([{page:"add",action:"store",redirect:"",message:"Данные добавлены",message_error:"Произошла ошибка"},{page:"images",action:"store",redirect:"",message:"Данные добавлены",message_error:"Произошла ошибка"},{page:"edit",action:"update",redirect:"",message:"Данные обновлены",message_error:"Произошла ошибка"},{page:"list",action:"delete",redirect:"list",message:"Данные удалены",message_error:"Произошла ошибка"},{page:"basket",action:"getProducts",header:"application/x-www-form-urlencoded"}]);if(V.length>0){const e=document.createElement("div");e.classList.add("basket-products");const t=document.createElement("div"),n=document.querySelector("#basket"),a=document.querySelector("#cart-data");let r=0,s=0;const o=[],i=V.shift(),c=JSON.parse(localStorage.getItem("steamCart"));0===c.length&&window.setTimeout((function(){window.location="/"}),500);for(const e of c)o.push(Number.parseInt(e.id));v(0,i.action,i.header)(o).then((o=>{const i=JSON.parse(o);for(const[t,a]of i.entries())r+=c[t].finalPrice,s+=c[t].count,e.innerHTML+=`<div class='product-in-cart__image'><img src='images/administrator/${a.cover_game}' alt='${a.name_game}'></div><div class='product-in-cart__description'><h2 class='<h2'>${a.name_game}</h2><div class='product-in-cart__company-information'>${a.company.name_company}</div><div class='product-in-cart__price-information'>${c[t].finalPrice} &#x20bd<span>(x${c[t].count})</span><span class='discount'>${a.tax.tax} %</span></div><div class='product-in-cart__product-categories'><ul class='column is-12'><li>${a.genre.name_genre}</li></ul></div><div class='product-in-cart__delete-from-cart'><a class='delete-link' data-el='${c[t].id}' id='${c[t].id}'>удалить из корзины</a></div></div>`,n.append(e);t.innerHTML+=`${s}<br>${r}&#x20bd <br>`,a.append(t)})).catch((e=>console.error(e))),setTimeout((function(){for(const e of document.querySelectorAll(".delete-link"))e.addEventListener("click",(e=>{C(e.target.dataset.el);const t=document.querySelectorAll(".cart-products")[0];t&&t.remove(),M(),window.setTimeout((function(){window.location="/basket"}),500)}))}),1e3)}n(72);const q=document.querySelector("#deleteUserpic");q&&q.addEventListener("click",(function(){Swal.fire({title:"Вы хотите удалить фото профиля?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Отмена",confirmButtonText:"Да"}).then((e=>{if(e.isConfirmed){const e={header:"application/x-www-form-urlencoded"},t="delete_userpic",n={};v(0,t,e.header)(n,t,e.header).then((e=>{""==e.trim()?y("Данные обновлены"):y("Произошла ошибка","error")})).catch((e=>console.error(e))),setTimeout(w("/account/edit"),2e3)}}))})),n(619);var P=[];const O=document.querySelector("#searchField");function $(e,t){const n=JSON.parse(e);for(;t.firstChild;)t.firstChild.remove();for(const e of n){const n=document.createElement("div");n.classList.add("column"),n.classList.add("is-one-quarter"),n.classList.add("game"),n.innerHTML+=`\n                    <div class="game-cover">\n                        <div class="buu">\n                            <div class="buy" id="${e.GameInfo.id}">\n                                <span class="icon">\n                                    <ion-icon name="cart-outline"></ion-icon>\n                                </span>\n                                Добавить в корзину\n                            </div>\n                            <figure class='image is-full'>\n                                <img src="images/administrator/${e.GameInfo.cover_game}" alt="${e.GameInfo.name_game}">\n                            </figure>\n                        </div>\n                    </div>\n                    <div class="game-description">\n                        <div class="game-title">\n                            <a href="/game?id=<?=$game->id;?>" class="game-name">\n                                ${e.GameInfo.name_game}\n                            </a>\n                        </div>\n                        <div class="game-company">\n                            ${e.company.name_company}\n                        </div>\n                        <div class="game-price">\n                            ${e.GameInfo.base_price} &#x20bd\n                            <span class="discount">-${e.tax}%</span>\n                        </div>\n                    </div>`,t.append(n)}}(async()=>{const e=await fetch("/v1/games/all");if(!e.ok)throw new Error(`Ошибка по адресу ${url}, статус ошибки ${fetchResp.status}`);return await e.text()})().then((e=>{P.push(JSON.parse(e))})).catch((e=>{console.log(e)})),document.getElementById("searchBlock").addEventListener("keydown",(e=>{O.innerHTML="";const t=P[0].filter((t=>{const n=e.key.toLowerCase();return t.game_name.toLowerCase().includes(n)}));for(const e of t){const t=document.createElement("div");t.innerHTML+=`<div><a href="game?id=${e.game_id}">${e.game_name}</a></div>`,O.append(t)}})),n(59);const A=document.querySelector("#dashboard");document.querySelector("#selector-games").addEventListener("change",(function(){y("Загружаем игры...","info"),v(this.value,"selector","application/x-www-form-urlencoded")(this.value).then((e=>{$(e,A)})).catch((e=>{console.log(e)}))}));const F=document.querySelector("#dashboard");document.querySelector("#selector-genres").addEventListener("change",(function(){y("Загружаем игры...","info"),v(this.value,"selector-genres","application/x-www-form-urlencoded")(this.value).then((e=>{$(e,F)})).catch((e=>{console.log(e)}))}));let I=document.getElementById("dashboard");document.getElementById("selector-companies").addEventListener("change",(function(){y("Загружаем игры...","info"),v(this.value,"selector-companies","application/x-www-form-urlencoded")(this.value).then((e=>{$(e,I)})).catch((e=>{console.log(e)}))}));var B=n(698);function N(){const e=document.querySelector("#phone").value,t=document.querySelector("#password").value,n=function(e){return 11==e.replace(/\D/g,"").length}(e),a=function(e){return!(e.trim().length<5)}(t);return!(!n||!a)}const R=document.querySelector("#enterToAccount");function D(e,t){const n="application/x-www-form-urlencoded",a={phone:document.querySelector("#phone").value,password:document.querySelector("#password").value},r=JSON.stringify(a);v(0,e,n)(r,e,n).then((e=>{0!=e?window.setTimeout((function(){window.location="/"}),500):Swal.fire(t,"","error")})).catch((e=>{console.log(e)}))}R&&R.addEventListener("click",(function(){Swal.fire({title:"Войти в аккаунт",html:'<input id="phone" type="tel" class="auth-field input-selector" placeholder="Номер телефона"><input id="password" type="password" class="auth-field" placeholder="Пароль">',preConfirm:()=>{N()?D("auth","Введён неверный логин или пароль"):Swal.showValidationMessage("Не все данные введены!")},backdrop:'\n              rgba(18,97,199,0.4)\n              url("/images/nyan-cat.gif")\n              left tops\n              no-repeat\n            ',showConfirmButton:!0,showDenyButton:!0,background:"linear-gradient(135deg, #dfe9f3 10%, #ffffff 100%)",confirmButtonColor:"#0C57C7",confirmButtonText:"Войти",denyButtonText:"или зарегестрироваться"}).then((e=>{e.isConfirmed?Swal.fire("Вы успешно вошли","","success"):e.isDenied&&(Swal.fire({title:"Зарегестрироваться",html:'<input id="phone" type="tel" class="auth-field input-selector" placeholder="Номер телефона"><input id="password" type="password" class="auth-field" placeholder="Пароль">',preConfirm:()=>{N()?D("register","Такой пользователь уже зарегестрирован"):Swal.showValidationMessage("Не все данные введены!")},showConfirmButton:!0,background:"linear-gradient(135deg, #dfe9f3 10%, #ffffff 100%)",confirmButtonColor:"#0C57C7",confirmButtonText:"Зарегестрироваться"}).then((e=>{e.isConfirmed&&N()&&Swal.fire("Вы успешно зарегестрировались","","success")})),new B.Z(document.querySelector(".input-selector"),{mask:"+7-(000)-000-00-00",alwaysShowMask:!0,maskChar:"_"}))})),new B.Z(document.querySelector(".input-selector"),{mask:"+7-(000)-000-00-00",alwaysShowMask:!0,maskChar:"_"})})),n(514)})()})();